<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
            PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
            "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="FAD0011">

	<!-- get list company -->
	<select id="getListCompany" resultClass="jp.co.cyms.apps.fad001.bean.CompanyBean">
		SELECT
		COMPANY_MST.COMPANY_CD as companyCd,
		COMPANY_MST.COMPANY_NAME as companyName
		FROM COMPANY_MST
		LEFT JOIN COUNTRY_MST ON COMPANY_MST.COUNTRY_CD = COUNTRY_MST.COUNTRY_CD
		ORDER BY COUNTRY_MST.DISPLAY_ORDER ASC
	</select>

	<!-- Get orders by monthly cost -->
	<select id="getOrdersByMonthlyCost" parameterClass="jp.co.cyms.apps.fad001.form.Pad0011Form"
		resultClass="jp.co.cyms.apps.fad001.bean.Pad0011Bean">
		SELECT *
		FROM
		(SELECT *
		FROM
		(SELECT ORDERS.DEPT_CD AS DEPTCD,
		DEPT_MST.DEPT_NAME AS DEPTNAME,
		ORDERS.COMPANY_CD AS COMPANYCD,
		COMPANY_MST.COMPANY_NAME AS COMPANYNAME,
		ORDER_DTL.ORDER_ID AS orderId,
		ORDER_DTL.CATEGORY_CD AS CATEGORYCD,
		CATEGORY_MST.CATEGORY_NAME AS CATEGORYNAME,
		ORDER_CFG.ADDON_CD AS ADDONCD,
		ADDON_MST.ADDON_name AS ADDONNAME,
		ORDER_CFG.ITEM_CD AS ITEMCD,
		ITEM_MST.ITEM_NAME AS ITEMNAME,
		TO_CHAR(ORDERS.BILL_MTH_START) AS billMthStart,
		TO_CHAR(ORDERS.BILL_MTH_END) AS billMthEnd,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &gt;= TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		ELSE NULL
		END AS billableQuantity ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &gt;= TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverQuantity ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &gt;= TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		ELSE NULL
		END billableAmount ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &gt;= TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverAmount
		FROM ORDER_DTL
		INNER JOIN ORDER_CFG
		ON ORDER_DTL.ORDER_ID = ORDER_CFG.ORDER_ID AND ORDER_CFG.LEASE_TYPE =
		'MRC'
		LEFT JOIN CATEGORY_MST
		ON CATEGORY_MST.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		LEFT JOIN ADDON_MST
		ON ADDON_MST.ADDON_CD = ORDER_CFG.ADDON_CD
		LEFT JOIN ORDERS
		ON ORDERS.ORDER_ID = ORDER_DTL.ORDER_ID
		LEFT JOIN ITEM_MST
		ON ITEM_MST.ITEM_CD = ORDER_CFG.ITEM_CD
		LEFT JOIN COMPANY_MST
		ON COMPANY_MST.COMPANY_CD = ORDERS.COMPANY_CD
		LEFT JOIN DEPT_MST
		ON DEPT_MST.DEPT_CD = ORDERS.DEPT_CD AND DEPT_MST.COMPANY_CD =
		ORDERS.COMPANY_CD
		LEFT JOIN
		(SELECT ORDER_ID,
		CATEGORY_CD, ITEM_CD,
		MAX(DELIVER_DT) DELIVER_DT,
		MAX(END_DT) END_DT
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.LEASE_TYPE = 'MRC'
		GROUP BY ORDER_ID,
		CATEGORY_CD, ITEM_CD
		) ORDER_LEASE
		ON ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		WHERE ORDERS.COUNTRY_CD = ITEM_MST.COUNTRY_CD
		AND LAST_DAY(TO_DATE(#year#||'/'||#month#, 'YYYY/MM')) BETWEEN
		ORDER_LEASE.DELIVER_DT AND ORDER_LEASE.END_DT
		AND ORDER_DTL.CATEGORY_CD = ORDER_CFG.CATEGORY_CD
		)
		UNION ALL
		SELECT *
		FROM
		(SELECT ORDERS.DEPT_CD AS DEPTCD,
		DEPT_MST.DEPT_NAME AS DEPTNAME,
		ORDERS.COMPANY_CD AS COMPANYCD,
		COMPANY_MST.COMPANY_NAME AS COMPANYNAME,
		ORDER_DTL.ORDER_ID AS orderId,
		ORDER_DTL.CATEGORY_CD AS CATEGORYCD,
		CATEGORY_MST.CATEGORY_NAME AS CATEGORYNAME,
		'' AS ADDONCD,
		'Model' AS ADDONNAME,
		ORDER_DTL.ITEM_CD AS ITEMCD,
		ITEM_MST.ITEM_NAME AS ITEMNAME ,
		TO_CHAR(ORDERS.BILL_MTH_START) AS billMthStart,
		TO_CHAR(ORDERS.BILL_MTH_END) AS billMthEnd,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &gt;= TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') = (SELECT TRUNC(MAX(ORDER_LEASE.DELIVER_MTH),
		'MM') FROM ORDER_LEASE WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD AND
		ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &gt;= TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') = (SELECT TRUNC(MAX(ORDER_LEASE.DELIVER_MTH),
		'MM') FROM ORDER_LEASE WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD AND
		ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(
		(SELECT COUNT(*)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverQuantity ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &gt;= TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') = (SELECT TRUNC(MAX(ORDER_LEASE.DELIVER_MTH),
		'MM') FROM ORDER_LEASE WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD AND
		ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &gt;= TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') = (SELECT TRUNC(MAX(ORDER_LEASE.DELIVER_MTH),
		'MM') FROM ORDER_LEASE WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD AND
		ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_DTL.UNIT_PRICE*
		(SELECT COUNT( *)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverAmount
		FROM ORDER_DTL
		LEFT JOIN CATEGORY_MST
		ON CATEGORY_MST.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		LEFT JOIN ORDERS
		ON ORDERS.ORDER_ID = ORDER_DTL.ORDER_ID
		LEFT JOIN ITEM_MST
		ON ITEM_MST.ITEM_CD = ORDER_DTL.ITEM_CD
		LEFT JOIN COMPANY_MST
		ON COMPANY_MST.COMPANY_CD = ORDERS.COMPANY_CD
		LEFT JOIN DEPT_MST
		ON DEPT_MST.DEPT_CD = ORDERS.DEPT_CD AND DEPT_MST.COMPANY_CD =
		ORDERS.COMPANY_CD
		LEFT JOIN
		(SELECT ORDER_ID,
		CATEGORY_CD, ITEM_CD,
		MAX(DELIVER_DT) DELIVER_DT,
		MAX(END_DT) END_DT
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.LEASE_TYPE = 'MRC'
		GROUP BY ORDER_ID,
		CATEGORY_CD, ITEM_CD
		) ORDER_LEASE
		ON ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		WHERE ORDERS.COUNTRY_CD = ITEM_MST.COUNTRY_CD
		AND LAST_DAY(TO_DATE(#year#||'/'||#month#, 'YYYY/MM')) BETWEEN
		ORDER_LEASE.DELIVER_DT AND ORDER_LEASE.END_DT
		AND ORDER_DTL.ORDER_ID = ORDERS.ORDER_ID
		)
		)
		<!-- WHERE SUBSTR(ORDERID, 1, 2) = SUBSTR(#year#, -2) -->
		ORDER BY ORDERID,
		CATEGORYCD,
		CASE
		WHEN ADDONCD IS NULL
		THEN 0
		ELSE 1
		END,
		ADDONNAME DESC
	</select>

	<!-- Get orders by one time cost -->
	<select id="getOrdersByOneTimeCost" parameterClass="jp.co.cyms.apps.fad001.form.Pad0011Form"
		resultClass="jp.co.cyms.apps.fad001.bean.Pad0011Bean">
		SELECT ORDERS.DEPT_CD AS DEPTCD,
		DEPT_MST.DEPT_NAME AS DEPTNAME,
		ORDERS.COMPANY_CD AS COMPANYCD,
		COMPANY_MST.COMPANY_NAME AS COMPANYNAME,
		ORDER_DTL.ORDER_ID AS ORDERID,
		ORDER_DTL.CATEGORY_CD AS CATEGORYCD,
		CATEGORY_MST.CATEGORY_NAME AS CATEGORYNAME,
		ORDER_CFG.ADDON_CD AS ADDONCD,
		ADDON_MST.ADDON_name AS ADDONNAME,
		ORDER_CFG.ITEM_CD AS ITEMCD,
		ITEM_MST.ITEM_NAME AS ITEMNAME ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &gt;= TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') = (SELECT TRUNC(MAX(ORDER_LEASE.DELIVER_MTH),
		'MM') FROM ORDER_LEASE WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD AND
		ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &gt;= TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') = (SELECT TRUNC(MAX(ORDER_LEASE.DELIVER_MTH),
		'MM') FROM ORDER_LEASE WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD AND
		ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverQuantity ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &gt;= TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') = (SELECT TRUNC(MAX(ORDER_LEASE.DELIVER_MTH),
		'MM') FROM ORDER_LEASE WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD AND
		ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &gt;= TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'),'MM') = (SELECT TRUNC(MAX(ORDER_LEASE.DELIVER_MTH),
		'MM') FROM ORDER_LEASE WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD AND
		ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.UNIT_PRICE*ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverAmount
		FROM ORDER_DTL
		INNER JOIN ORDER_CFG
		ON ORDER_DTL.ORDER_ID
		= ORDER_CFG.ORDER_ID AND ORDER_CFG.LEASE_TYPE = 'OTC'
		LEFT JOIN
		CATEGORY_MST
		ON CATEGORY_MST.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		LEFT
		JOIN ADDON_MST
		ON ADDON_MST.ADDON_CD = ORDER_CFG.ADDON_CD
		LEFT JOIN
		ORDERS
		ON ORDERS.ORDER_ID = ORDER_DTL.ORDER_ID
		LEFT JOIN ITEM_MST
		ON
		ITEM_MST.ITEM_CD = ORDER_CFG.ITEM_CD
		LEFT JOIN COMPANY_MST
		ON COMPANY_MST.COMPANY_CD = ORDERS.COMPANY_CD
		LEFT JOIN DEPT_MST
		ON DEPT_MST.DEPT_CD = ORDERS.DEPT_CD AND DEPT_MST.COMPANY_CD =
		ORDERS.COMPANY_CD
		LEFT JOIN
		(SELECT ORDER_ID,
		CATEGORY_CD, ITEM_CD,
		MAX(DELIVER_DT) DELIVER_DT,
		MAX(END_DT) END_DT
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.LEASE_TYPE = 'MRC'
		GROUP BY ORDER_ID,
		CATEGORY_CD, ITEM_CD
		) ORDER_LEASE
		ON ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		WHERE ORDERS.COUNTRY_CD = ITEM_MST.COUNTRY_CD
		AND ORDER_DTL.CATEGORY_CD =
		ORDER_CFG.CATEGORY_CD
		AND TO_CHAR(ORDER_LEASE.DELIVER_DT, 'YYYY/MM') =
    	TO_CHAR(TO_DATE(#year#||'/'||#month#, 'YYYY/MM'), 'YYYY/MM')
		<!-- AND LAST_DAY(TO_DATE(#year#||'/'||#month#,
		'YYYY/MM')) BETWEEN ORDER_LEASE.DELIVER_DT AND ORDER_LEASE.END_DT -->
		<!-- AND SUBSTR(ORDER_DTL.ORDER_ID, 1, 2) = SUBSTR(#year#, -2) -->
		<!-- AND TO_DATE(#year#||'/'||#month#||'/1', 'YYYY/MM/DD') -->
		ORDER BY ORDER_DTL.ORDER_ID,
		ORDER_DTL.CATEGORY_CD,
		CASE
		WHEN ORDER_CFG.ADDON_CD IS NULL
		THEN 0
		ELSE 1
		END,
		ADDON_MST.ADDON_NAME DESC
	</select>

	<!-- Get orders by one time cost -->
	<select id="getPCLeaseData" parameterClass="jp.co.cyms.apps.fad001.form.Pad0011Form"
		resultClass="jp.co.cyms.apps.fad001.bean.OrderLeaseBean">
		SELECT ROW_NUMBER() OVER (ORDER BY ORDERS.ORDER_ID) AS SEQ,
		ORDERS.COMPANY_CD AS COMPANYCD,
		ORDERS.DEPT_CD AS DEPTCD,
		ORDER_LEASE.QUOTE_MRC
		|| '/'
		|| ORDER_LEASE.QUOTE_OTC AS QUOTATIONNO,
		ORDER_LEASE.LEASE_NO AS LEASENO,
		ORDER_DTL.UNIT_PRICE AS LEASEFEE,
		TO_CHAR(ORDER_LEASE.DELIVER_DT, 'MM-DD-YYYY') AS DELIVERDT,
		TO_CHAR(ORDER_LEASE.END_DT, 'MM-DD-YYYY') AS ENDDT,
		TO_CHAR(ORDER_LEASE.WARRANTY_DT, 'MM-DD-YYYY') AS WARRANTYDT,
		ORDER_LEASE.CATEGORY_CD AS CATEGORYCD,
		ORDER_LEASE.ITEM_CD AS ITEMCD,
		ORDER_LEASE.SERIAL_NO AS SERIALNO,
		ORDER_LEASE.LEASE_STATUS AS ACTIVESTATUS
		FROM ORDERS
		LEFT JOIN ORDER_LEASE
		ON
		ORDER_LEASE.ORDER_ID = ORDERS.ORDER_ID
		LEFT JOIN ORDER_DTL
		ON ORDER_DTL.ORDER_ID = ORDER_LEASE.ORDER_ID AND ORDER_DTL.ITEM_CD =
		ORDER_LEASE.ITEM_CD
		WHERE 1 = 1
		<isNotEmpty property="country">
			AND ORDERS.COUNTRY_CD = #country#
			<isNotEmpty property="company">
				AND ORDERS.COMPANY_CD = #company#
			</isNotEmpty>
		</isNotEmpty>
		<isEqual property="statusActive" compareValue="true">
			AND SYSDATE &lt; ORDER_LEASE.END_DT
		</isEqual>
		AND ORDER_LEASE.LEASE_STATUS IS NOT NULL
		AND (ORDERS.DELETE_FG IS NULL OR ORDERS.DELETE_FG != '1')
		ORDER BY
		ORDERS.ORDER_ID, ORDERS.COMPANY_CD, ORDERS.DEPT_CD
	</select>

	<!-- Excel PC Lease Invoice Data (S) Total_Summary -->
	<select id="getLeaseInvoiceDataSTotalSummary" parameterClass="jp.co.cyms.apps.fad001.form.Pad0011Form"
		resultClass="jp.co.cyms.apps.fad001.bean.ExcelPCLeaseInvoiceDataSBean">
		<!-- SELECT * FROM (SELECT CASE WHEN UPPER(CATEGORY_MST.CATEGORY_ABBREV) 
			= 'DP' THEN 'Desktop' WHEN UPPER(CATEGORY_MST.CATEGORY_ABBREV) = 'LM' THEN 
			'Laptop(M)' WHEN UPPER(CATEGORY_MST.CATEGORY_ABBREV) = 'LL' THEN 'Laptop(L)' 
			ELSE 'Mobile' END AS categoryName, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'01', 
			'YYYY/MM'),'MM') >= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'01', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Jan, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'01', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE 
			END) AS JanSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'02', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Feb, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'02', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE 
			END) AS FebSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'03', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Mar, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'03', 
			'YYYY/MM'),'MM')&lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE 
			END) AS MarSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'04', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Apr, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'04', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE 
			END) AS AprSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'05', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS May, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'05', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE 
			END) AS MaySum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'06', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Jun, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'06', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE 
			END) AS JunSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'07', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Jul, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'07', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE 
			END) AS JulSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'08', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Aug, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'08', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE 
			END) AS AugSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'09', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Sep, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'09', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE 
			END) AS SepSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'10', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Oct, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'10', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE 
			END) AS OctSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'11', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Nov, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'11', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE 
			END) AS NovSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'12', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS DEC, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') 
			>= TRUNC(ORDERS.BILL_MTH_START,'MM') AND TRUNC(TO_DATE(#year#||'/'||'12', 
			'YYYY/MM'),'MM') &lt;= TRUNC(ORDERS.BILL_MTH_END,'MM') THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE 
			END) AS DecSum FROM ORDER_DTL LEFT JOIN ORDERS ON ORDERS.ORDER_ID = ORDER_DTL.ORDER_ID 
			LEFT JOIN CATEGORY_MST ON CATEGORY_MST.CATEGORY_CD = ORDER_DTL.CATEGORY_CD 
			WHERE ORDERS.BILL_FG = '1' AND ORDER_DTL.LEASE_TYPE = 'MRC' AND TO_CHAR(ORDERS.BILL_MTH_START, 
			'YYYY') &lt;= #year# AND TO_CHAR(ORDERS.BILL_MTH_END, 'YYYY') &gt;= #year# 
			GROUP BY ORDER_DTL.CATEGORY_CD, CATEGORY_MST.CATEGORY_ABBREV ORDER BY CATEGORY_MST.CATEGORY_ABBREV 
			) UNION ALL SELECT * FROM (SELECT 'One Time Cost' AS categoryName, SUM( CASE 
			WHEN TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') 
			THEN ORDER_CFG.ITEM_QTY END) AS Jan, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'01', 
			'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE 
			END) AS JanSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') 
			= TRUNC(ORDERS.BILL_MTH_START,'MM') THEN ORDER_CFG.ITEM_QTY END) AS Feb, 
			SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') 
			THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS FebSum, SUM( CASE WHEN 
			TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') 
			THEN ORDER_CFG.ITEM_QTY END) AS Mar, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'03', 
			'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE 
			END) AS MarSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') 
			= TRUNC(ORDERS.BILL_MTH_START,'MM') THEN ORDER_CFG.ITEM_QTY END) AS Apr, 
			SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') 
			THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS AprSum, SUM( CASE WHEN 
			TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') 
			THEN ORDER_CFG.ITEM_QTY END) AS May, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'05', 
			'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE 
			END) AS MaySum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') 
			= TRUNC(ORDERS.BILL_MTH_START,'MM') THEN ORDER_CFG.ITEM_QTY END) AS Jun, 
			SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') 
			THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS JunSum, SUM( CASE WHEN 
			TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') 
			THEN ORDER_CFG.ITEM_QTY END) AS Jul, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'07', 
			'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE 
			END) AS JulSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') 
			= TRUNC(ORDERS.BILL_MTH_START,'MM') THEN ORDER_CFG.ITEM_QTY END) AS Aug, 
			SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') 
			THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS AugSum, SUM( CASE WHEN 
			TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') 
			THEN ORDER_CFG.ITEM_QTY END) AS Sep, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'09', 
			'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE 
			END) AS SepSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') 
			= TRUNC(ORDERS.BILL_MTH_START,'MM') THEN ORDER_CFG.ITEM_QTY END) AS Oct, 
			SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') 
			THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS OctSum, SUM( CASE WHEN 
			TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') 
			THEN ORDER_CFG.ITEM_QTY END) AS Nov, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'11', 
			'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE 
			END) AS NovSum, SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') 
			= TRUNC(ORDERS.BILL_MTH_START,'MM') THEN ORDER_CFG.ITEM_QTY END) AS DEC, 
			SUM( CASE WHEN TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') = TRUNC(ORDERS.BILL_MTH_START,'MM') 
			THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS DecSum FROM ORDER_CFG 
			LEFT JOIN ORDERS ON ORDERS.ORDER_ID = ORDER_CFG.ORDER_ID WHERE ORDERS.BILL_FG 
			= '1' AND ORDER_CFG.LEASE_TYPE = 'OTC' AND TO_CHAR(ORDERS.BILL_MTH_START, 
			'YYYY') &lt;= #year# AND TO_CHAR(ORDERS.BILL_MTH_END, 'YYYY') &gt;= #year# 
			) -->
	</select>
	<!-- MRC -->
	<select id="getLeaseInvoiceDataSTotalSummaryMRC" parameterClass="jp.co.cyms.apps.fad001.form.Pad0011Form"
		resultClass="jp.co.cyms.apps.fad001.bean.ExcelPCLeaseInvoiceDataSBean">
		SELECT
		COUNTRY_MST.COUNTRY_CD as countryCd,
		COMPANY_MST.COMPANY_CD AS companyCd,
		COMPANY_MST.COMPANY_NAME AS companyName,
		CATEGORY_MST.CATEGORY_CD categoryCd,
		(
		CASE
		WHEN CATEGORY_MST.CATEGORY_NAME = 'OS'
		THEN 'OS'
		ELSE CATEGORY_MST.CATEGORY_NAME
		END ) categoryName,
		(
		CASE
		WHEN T1.Jan IS NULL THEN 0
		ELSE T1.Jan
		END
		) Jan,
		(
		CASE
		WHEN T1.JanSum IS NULL THEN 0
		ELSE T1.JanSum
		END
		) JanSum,
		(
		CASE
		WHEN T1.Feb IS NULL THEN 0
		ELSE T1.Feb
		END
		) Feb,
		(
		CASE
		WHEN T1.FebSum IS NULL THEN 0
		ELSE T1.FebSum
		END
		) FebSum,
		(
		CASE
		WHEN T1.Mar IS NULL THEN 0
		ELSE T1.Mar
		END
		) Mar,
		(
		CASE
		WHEN T1.MarSum IS NULL THEN 0
		ELSE T1.MarSum
		END
		) MarSum,
		(
		CASE
		WHEN T1.Apr IS NULL THEN 0
		ELSE T1.Apr
		END
		) Apr,
		(
		CASE
		WHEN T1.AprSum IS NULL THEN 0
		ELSE T1.AprSum
		END
		) AprSum,
		(
		CASE
		WHEN T1.May IS NULL THEN 0
		ELSE T1.May
		END
		) May,
		(
		CASE
		WHEN T1.MaySum IS NULL THEN 0
		ELSE T1.MaySum
		END
		) MaySum,
		(
		CASE
		WHEN T1.Jun IS NULL THEN 0
		ELSE T1.Jun
		END
		) Jun,
		(
		CASE
		WHEN T1.JunSum IS NULL THEN 0
		ELSE T1.JunSum
		END
		) JunSum,
		(
		CASE
		WHEN T1.Jul IS NULL THEN 0
		ELSE T1.Jul
		END
		) Jul,
		(
		CASE
		WHEN T1.JulSum IS NULL THEN 0
		ELSE T1.JulSum
		END
		) JulSum,
		(
		CASE
		WHEN T1.Aug IS NULL THEN 0
		ELSE T1.Aug
		END
		) Aug,
		(
		CASE
		WHEN T1.AugSum IS NULL THEN 0
		ELSE T1.AugSum
		END
		) AugSum,
		(
		CASE
		WHEN T1.Sep IS NULL THEN 0
		ELSE T1.Sep
		END
		) Sep,
		(
		CASE
		WHEN T1.SepSum IS NULL THEN 0
		ELSE T1.SepSum
		END
		) SepSum,
		(
		CASE
		WHEN T1.Oct IS NULL THEN 0
		ELSE T1.Oct
		END
		) Oct,
		(
		CASE
		WHEN T1.OctSum IS NULL THEN 0
		ELSE T1.OctSum
		END
		) OctSum,
		(
		CASE
		WHEN T1.Nov IS NULL THEN 0
		ELSE T1.Nov
		END
		) Nov,
		(
		CASE
		WHEN T1.NovSum IS NULL THEN 0
		ELSE T1.NovSum
		END
		) NovSum,
		(
		CASE
		WHEN T1.Dec IS NULL THEN 0
		ELSE T1.Dec
		END
		) Dec,
		(
		CASE
		WHEN T1.DecSum IS NULL THEN 0
		ELSE T1.DecSum
		END
		) DecSum
		FROM COUNTRY_MST
		LEFT JOIN COMPANY_MST
		ON COMPANY_MST.COUNTRY_CD = COUNTRY_MST.COUNTRY_CD
		LEFT JOIN CATEGORY_MST
		ON CATEGORY_MST.CATEGORY_TYPE = 'MRC'
		LEFT JOIN
		( SELECT ORDERS.COUNTRY_CD as countryCd, ORDERS.COMPANY_CD as
		companyCd, ORDER_DTL.CATEGORY_CD as categoryCd,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Jan,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS JanSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Feb,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS FebSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Mar,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')&lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS MarSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Apr,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS AprSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS May,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS MaySum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Jun,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS JunSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Jul,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS JulSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Aug,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS AugSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Sep,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS SepSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Oct,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS OctSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Nov,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS NovSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS DEC,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS DecSum
		FROM ORDERS
		LEFT JOIN ORDER_DTL
		ON ORDER_DTL.ORDER_ID = ORDERS.ORDER_ID
		LEFT JOIN CATEGORY_MST
		ON CATEGORY_MST.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		WHERE ORDERS.BILL_FG = '1'
		AND ORDER_DTL.LEASE_TYPE = 'MRC'
		AND TO_CHAR(ORDERS.BILL_MTH_START, 'YYYY') &lt;= #year#
		AND TO_CHAR(ORDERS.BILL_MTH_END, 'YYYY') &gt;= #year#
		GROUP BY ORDERS.COUNTRY_CD, ORDERS.COMPANY_CD, ORDER_DTL.CATEGORY_CD
		) T1
		ON T1.countryCd = COMPANY_MST.COUNTRY_CD
		AND T1.companyCd = COMPANY_MST.COMPANY_CD
		AND T1.categoryCd = CATEGORY_MST.CATEGORY_CD
		WHERE CATEGORY_MST.CATEGORY_CD != '99WINDOWS'
		ORDER BY COMPANY_MST.COUNTRY_CD, COMPANY_MST.COMPANY_CD,
		CATEGORY_MST.CATEGORY_CD
	</select>
	<!-- OTC -->
	<select id="getLeaseInvoiceDataSTotalSummaryOTC" parameterClass="jp.co.cyms.apps.fad001.form.Pad0011Form"
		resultClass="jp.co.cyms.apps.fad001.bean.ExcelPCLeaseInvoiceDataSBean">

		SELECT
		COUNTRY_MST.COUNTRY_CD as countryCd,
		COMPANY_MST.COMPANY_CD AS companyCd,
		'One Time Cost' categoryCd,
		'One Time Cost' categoryName,
		(
		CASE
		WHEN T1.Jan IS NULL THEN 0
		ELSE T1.Jan
		END
		) Jan,
		(
		CASE
		WHEN T1.JanSum IS NULL THEN 0
		ELSE T1.JanSum
		END
		) JanSum,
		(
		CASE
		WHEN T1.Feb IS NULL THEN 0
		ELSE T1.Feb
		END
		) Feb,
		(
		CASE
		WHEN T1.FebSum IS NULL THEN 0
		ELSE T1.FebSum
		END
		) FebSum,
		(
		CASE
		WHEN T1.Mar IS NULL THEN 0
		ELSE T1.Mar
		END
		) Mar,
		(
		CASE
		WHEN T1.MarSum IS NULL THEN 0
		ELSE T1.MarSum
		END
		) MarSum,
		(
		CASE
		WHEN T1.Apr IS NULL THEN 0
		ELSE T1.Apr
		END
		) Apr,
		(
		CASE
		WHEN T1.AprSum IS NULL THEN 0
		ELSE T1.AprSum
		END
		) AprSum,
		(
		CASE
		WHEN T1.May IS NULL THEN 0
		ELSE T1.May
		END
		) May,
		(
		CASE
		WHEN T1.MaySum IS NULL THEN 0
		ELSE T1.MaySum
		END
		) MaySum,
		(
		CASE
		WHEN T1.Jun IS NULL THEN 0
		ELSE T1.Jun
		END
		) Jun,
		(
		CASE
		WHEN T1.JunSum IS NULL THEN 0
		ELSE T1.JunSum
		END
		) JunSum,
		(
		CASE
		WHEN T1.Jul IS NULL THEN 0
		ELSE T1.Jul
		END
		) Jul,
		(
		CASE
		WHEN T1.JulSum IS NULL THEN 0
		ELSE T1.JulSum
		END
		) JulSum,
		(
		CASE
		WHEN T1.Aug IS NULL THEN 0
		ELSE T1.Aug
		END
		) Aug,
		(
		CASE
		WHEN T1.AugSum IS NULL THEN 0
		ELSE T1.AugSum
		END
		) AugSum,
		(
		CASE
		WHEN T1.Sep IS NULL THEN 0
		ELSE T1.Sep
		END
		) Sep,
		(
		CASE
		WHEN T1.SepSum IS NULL THEN 0
		ELSE T1.SepSum
		END
		) SepSum,
		(
		CASE
		WHEN T1.Oct IS NULL THEN 0
		ELSE T1.Oct
		END
		) Oct,
		(
		CASE
		WHEN T1.OctSum IS NULL THEN 0
		ELSE T1.OctSum
		END
		) OctSum,
		(
		CASE
		WHEN T1.Nov IS NULL THEN 0
		ELSE T1.Nov
		END
		) Nov,
		(
		CASE
		WHEN T1.NovSum IS NULL THEN 0
		ELSE T1.NovSum
		END
		) NovSum,
		(
		CASE
		WHEN T1.Dec IS NULL THEN 0
		ELSE T1.Dec
		END
		) Dec,
		(
		CASE
		WHEN T1.DecSum IS NULL THEN 0
		ELSE T1.DecSum
		END
		) DecSum
		FROM COUNTRY_MST
		LEFT JOIN COMPANY_MST
		ON COMPANY_MST.COUNTRY_CD = COUNTRY_MST.COUNTRY_CD
		LEFT JOIN
		( SELECT ORDERS.COUNTRY_CD as countryCd, ORDERS.COMPANY_CD as
		companyCd,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Jan,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS JanSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Feb,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS FebSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Mar,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS MarSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Apr,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS AprSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS May,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS MaySum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Jun,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS JunSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Jul,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS JulSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Aug,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS AugSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Sep,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS SepSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Oct,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS OctSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Nov,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS NovSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS DEC,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS DecSum
		FROM ORDERS
		LEFT JOIN ORDER_CFG
		ON ORDER_CFG.ORDER_ID = ORDERS.ORDER_ID
		LEFT JOIN ADDON_MST
		ON ADDON_MST.ADDON_CD = ORDER_CFG.ADDON_CD
		WHERE ORDERS.BILL_FG = '1'
		AND ORDER_CFG.LEASE_TYPE = 'OTC'
		AND TO_CHAR(ORDERS.BILL_MTH_START, 'YYYY') &lt;= #year#
		AND TO_CHAR(ORDERS.BILL_MTH_END, 'YYYY') &gt;= #year#
		GROUP BY ORDERS.COUNTRY_CD, ORDERS.COMPANY_CD
		) T1
		ON T1.countryCd = COMPANY_MST.COUNTRY_CD
		AND T1.companyCd = COMPANY_MST.COMPANY_CD
		ORDER BY COMPANY_MST.COUNTRY_CD, COMPANY_MST.COMPANY_CD

	</select>

	<!-- Excel PC Lease Invoice Data (S) Company Code -->
	<select id="getLeaseInvoiceDataSCompanyCode" parameterClass="jp.co.cyms.apps.fad001.form.Pad0011Form"
		resultClass="jp.co.cyms.apps.fad001.bean.ExcelPCLeaseInvoiceDataSBean">
		<!-- SELECT * FROM (SELECT COMPANY_MST.COMPANY_NAME AS companyName, DEPT_MST.DEPT_NAME 
			AS deptName, DEPT_MST.DEPT_CD AS deptCd, CASE WHEN UPPER(CATEGORY_MST.CATEGORY_ABBREV) 
			= 'DP' THEN 'Desktop' WHEN UPPER(CATEGORY_MST.CATEGORY_ABBREV) = 'LM' THEN 
			'Laptop(M)' WHEN UPPER(CATEGORY_MST.CATEGORY_ABBREV) = 'LL' THEN 'Laptop(L)' 
			ELSE 'Mobile' END AS categoryName, COMPANY_MST.COMPANY_CD AS companyCd, SUM( 
			CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '01' THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Jan, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '01' THEN 
			ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE END) AS JanSum, SUM( CASE 
			WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '02' THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Feb, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '02' THEN 
			ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE END) AS FebSum, SUM( CASE 
			WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '03' THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Mar, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '03' THEN 
			ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE END) AS MarSum, SUM( CASE 
			WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '04' THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Apr, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '04' THEN 
			ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE END) AS AprSum, SUM( CASE 
			WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '05' THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS May, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '05' THEN 
			ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE END) AS MaySum, SUM( CASE 
			WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '06' THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Jun, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '06' THEN 
			ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE END) AS JunSum, SUM( CASE 
			WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '07' THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Jul, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '07' THEN 
			ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE END) AS JulSum, SUM( CASE 
			WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '08' THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Aug, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '08' THEN 
			ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE END) AS AugSum, SUM( CASE 
			WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '09' THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Sep, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '09' THEN 
			ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE END) AS SepSum, SUM( CASE 
			WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '10' THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Oct, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '10' THEN 
			ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE END) AS OctSum, SUM( CASE 
			WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '11' THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS Nov, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '11' THEN 
			ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE END) AS NovSum, SUM( CASE 
			WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '12' THEN ORDER_DTL.KDDI_DELIVER_QTY 
			END) AS DEC, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '12' THEN 
			ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE END) AS DecSum FROM ORDER_DTL 
			LEFT JOIN ORDERS ON ORDERS.ORDER_ID = ORDER_DTL.ORDER_ID LEFT JOIN CATEGORY_MST 
			ON CATEGORY_MST.CATEGORY_CD = ORDER_DTL.CATEGORY_CD LEFT JOIN COMPANY_MST 
			ON COMPANY_MST.COMPANY_CD = ORDERS.COMPANY_CD LEFT JOIN DEPT_MST ON DEPT_MST.DEPT_CD 
			= ORDERS.DEPT_CD AND DEPT_MST.COMPANY_CD = ORDERS.COMPANY_CD WHERE ORDERS.BILL_FG 
			= '1' AND ORDER_DTL.LEASE_TYPE = 'MRC' AND TO_CHAR(ORDERS.BILL_MTH_START, 
			'YYYY') &lt;= #year# AND TO_CHAR(ORDERS.BILL_MTH_END, 'YYYY') &gt;= #year# 
			GROUP BY COMPANY_MST.COMPANY_NAME, DEPT_MST.DEPT_NAME, DEPT_MST.DEPT_CD, 
			CATEGORY_MST.CATEGORY_ABBREV, COMPANY_MST.COMPANY_CD ORDER BY COMPANY_MST.COMPANY_NAME 
			) UNION ALL SELECT * FROM (SELECT COMPANY_MST.COMPANY_NAME AS companyName, 
			DEPT_MST.DEPT_NAME AS deptName, DEPT_MST.DEPT_CD AS deptCd, 'One Time Cost' 
			AS categoryName, COMPANY_MST.COMPANY_CD AS companyCd, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 
			'MM') = '01' THEN ORDER_CFG.ITEM_QTY END) AS Jan, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 
			'MM') = '01' THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS JanSum, 
			SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '02' THEN ORDER_CFG.ITEM_QTY 
			END) AS Feb, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '02' THEN 
			ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS FebSum, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 
			'MM') = '03' THEN ORDER_CFG.ITEM_QTY END) AS Mar, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 
			'MM') = '03' THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS MarSum, 
			SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '04' THEN ORDER_CFG.ITEM_QTY 
			END) AS Apr, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '04' THEN 
			ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS AprSum, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 
			'MM') = '05' THEN ORDER_CFG.ITEM_QTY END) AS May, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 
			'MM') = '05' THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS MaySum, 
			SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '06' THEN ORDER_CFG.ITEM_QTY 
			END) AS Jun, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '06' THEN 
			ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS JunSum, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 
			'MM') = '07' THEN ORDER_CFG.ITEM_QTY END) AS Jul, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 
			'MM') = '07' THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS JulSum, 
			SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '08' THEN ORDER_CFG.ITEM_QTY 
			END) AS Aug, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '08' THEN 
			ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS AugSum, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 
			'MM') = '09' THEN ORDER_CFG.ITEM_QTY END) AS Sep, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 
			'MM') = '09' THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS SepSum, 
			SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '10' THEN ORDER_CFG.ITEM_QTY 
			END) AS Oct, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '10' THEN 
			ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS OctSum, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 
			'MM') = '11' THEN ORDER_CFG.ITEM_QTY END) AS Nov, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 
			'MM') = '11' THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS NovSum, 
			SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '12' THEN ORDER_CFG.ITEM_QTY 
			END) AS DEC, SUM( CASE WHEN TO_CHAR(ORDERS.BILL_MTH_START, 'MM') = '12' THEN 
			ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE END) AS DecSum FROM ORDER_CFG LEFT 
			JOIN ORDERS ON ORDERS.ORDER_ID = ORDER_CFG.ORDER_ID LEFT JOIN CATEGORY_MST 
			ON CATEGORY_MST.CATEGORY_CD = ORDER_CFG.CATEGORY_CD LEFT JOIN COMPANY_MST 
			ON COMPANY_MST.COMPANY_CD = ORDERS.COMPANY_CD LEFT JOIN DEPT_MST ON DEPT_MST.DEPT_CD 
			= ORDERS.DEPT_CD AND DEPT_MST.COMPANY_CD = ORDERS.COMPANY_CD WHERE ORDERS.BILL_FG 
			= '1' AND ORDER_CFG.LEASE_TYPE = 'OTC' AND TO_CHAR(ORDERS.BILL_MTH_START, 
			'YYYY') &lt;= #year# AND TO_CHAR(ORDERS.BILL_MTH_END, 'YYYY') &gt;= #year# 
			GROUP BY COMPANY_MST.COMPANY_NAME, DEPT_MST.DEPT_NAME, DEPT_MST.DEPT_CD, 
			COMPANY_MST.COMPANY_CD ORDER BY COMPANY_MST.COMPANY_NAME ) -->
		SELECT * FROM (
		SELECT
		COUNTRY_MST.COUNTRY_CD as countryCd,
		COMPANY_MST.COMPANY_CD AS companyCd,
		COMPANY_MST.COMPANY_NAME AS companyName,
		DEPT_MST.DEPT_CD deptCd,
		DEPT_MST.DEPT_NAME deptName,
		CATEGORY_MST.CATEGORY_CD categoryCd,
		(
		CASE
		WHEN CATEGORY_MST.CATEGORY_NAME = 'OS'
		THEN 'OS'
		ELSE CATEGORY_MST.CATEGORY_NAME
		END ) categoryName,
		(
		CASE
		WHEN T1.Jan IS NULL THEN 0
		ELSE T1.Jan
		END
		) Jan,
		(
		CASE
		WHEN T1.JanSum IS NULL THEN 0
		ELSE T1.JanSum
		END
		) JanSum,
		(
		CASE
		WHEN T1.Feb IS NULL THEN 0
		ELSE T1.Feb
		END
		) Feb,
		(
		CASE
		WHEN T1.FebSum IS NULL THEN 0
		ELSE T1.FebSum
		END
		) FebSum,
		(
		CASE
		WHEN T1.Mar IS NULL THEN 0
		ELSE T1.Mar
		END
		) Mar,
		(
		CASE
		WHEN T1.MarSum IS NULL THEN 0
		ELSE T1.MarSum
		END
		) MarSum,
		(
		CASE
		WHEN T1.Apr IS NULL THEN 0
		ELSE T1.Apr
		END
		) Apr,
		(
		CASE
		WHEN T1.AprSum IS NULL THEN 0
		ELSE T1.AprSum
		END
		) AprSum,
		(
		CASE
		WHEN T1.May IS NULL THEN 0
		ELSE T1.May
		END
		) May,
		(
		CASE
		WHEN T1.MaySum IS NULL THEN 0
		ELSE T1.MaySum
		END
		) MaySum,
		(
		CASE
		WHEN T1.Jun IS NULL THEN 0
		ELSE T1.Jun
		END
		) Jun,
		(
		CASE
		WHEN T1.JunSum IS NULL THEN 0
		ELSE T1.JunSum
		END
		) JunSum,
		(
		CASE
		WHEN T1.Jul IS NULL THEN 0
		ELSE T1.Jul
		END
		) Jul,
		(
		CASE
		WHEN T1.JulSum IS NULL THEN 0
		ELSE T1.JulSum
		END
		) JulSum,
		(
		CASE
		WHEN T1.Aug IS NULL THEN 0
		ELSE T1.Aug
		END
		) Aug,
		(
		CASE
		WHEN T1.AugSum IS NULL THEN 0
		ELSE T1.AugSum
		END
		) AugSum,
		(
		CASE
		WHEN T1.Sep IS NULL THEN 0
		ELSE T1.Sep
		END
		) Sep,
		(
		CASE
		WHEN T1.SepSum IS NULL THEN 0
		ELSE T1.SepSum
		END
		) SepSum,
		(
		CASE
		WHEN T1.Oct IS NULL THEN 0
		ELSE T1.Oct
		END
		) Oct,
		(
		CASE
		WHEN T1.OctSum IS NULL THEN 0
		ELSE T1.OctSum
		END
		) OctSum,
		(
		CASE
		WHEN T1.Nov IS NULL THEN 0
		ELSE T1.Nov
		END
		) Nov,
		(
		CASE
		WHEN T1.NovSum IS NULL THEN 0
		ELSE T1.NovSum
		END
		) NovSum,
		(
		CASE
		WHEN T1.Dec IS NULL THEN 0
		ELSE T1.Dec
		END
		) Dec,
		(
		CASE
		WHEN T1.DecSum IS NULL THEN 0
		ELSE T1.DecSum
		END
		) DecSum
		FROM COUNTRY_MST
		LEFT JOIN COMPANY_MST
		ON COMPANY_MST.COUNTRY_CD = COUNTRY_MST.COUNTRY_CD
		LEFT JOIN DEPT_MST
		ON DEPT_MST.COMPANY_CD = COMPANY_MST.COMPANY_CD
		LEFT JOIN CATEGORY_MST
		ON CATEGORY_MST.CATEGORY_TYPE = 'MRC'
		LEFT JOIN
		( SELECT ORDERS.COUNTRY_CD as countryCd, ORDERS.COMPANY_CD as
		companyCd, ORDERS.DEPT_CD as deptCd, ORDER_DTL.CATEGORY_CD as
		categoryCd,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Jan,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS JanSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Feb,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS FebSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Mar,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')&lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS MarSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Apr,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS AprSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS May,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS MaySum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Jun,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS JunSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Jul,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS JulSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Aug,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS AugSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Sep,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS SepSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Oct,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS OctSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS Nov,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS NovSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS DEC,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS DecSum
		FROM ORDERS
		LEFT JOIN ORDER_DTL
		ON ORDER_DTL.ORDER_ID = ORDERS.ORDER_ID
		LEFT JOIN CATEGORY_MST
		ON CATEGORY_MST.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		WHERE ORDERS.BILL_FG = '1'
		AND ORDER_DTL.LEASE_TYPE = 'MRC'
		AND TO_CHAR(ORDERS.BILL_MTH_START, 'YYYY') &lt;= #year#
		AND TO_CHAR(ORDERS.BILL_MTH_END, 'YYYY') &gt;= #year#
		GROUP BY ORDERS.COUNTRY_CD, ORDERS.COMPANY_CD, ORDER_DTL.CATEGORY_CD,
		ORDERS.DEPT_CD
		) T1
		ON T1.countryCd = COMPANY_MST.COUNTRY_CD
		AND T1.companyCd = COMPANY_MST.COMPANY_CD
		AND T1.deptCd = DEPT_MST.DEPT_CD
		AND T1.categoryCd = CATEGORY_MST.CATEGORY_CD
		WHERE CATEGORY_MST.CATEGORY_CD != '99WINDOWS'
		ORDER BY COMPANY_MST.COUNTRY_CD, COMPANY_MST.COMPANY_CD, DEPT_MST.DEPT_CD,
		CATEGORY_MST.CATEGORY_CD
		)
		UNION ALL
		SELECT *
		FROM
		(
		SELECT
		COUNTRY_MST.COUNTRY_CD as countryCd,
		COMPANY_MST.COMPANY_CD AS companyCd,
		COMPANY_MST.COMPANY_NAME AS companyName,
		DEPT_MST.DEPT_CD deptCd,
		DEPT_MST.DEPT_NAME deptName,
		'One Time Cost' categoryCd,
		'One Time Cost' categoryName,
		(
		CASE
		WHEN T1.Jan IS NULL THEN 0
		ELSE T1.Jan
		END
		) Jan,
		(
		CASE
		WHEN T1.JanSum IS NULL THEN 0
		ELSE T1.JanSum
		END
		) JanSum,
		(
		CASE
		WHEN T1.Feb IS NULL THEN 0
		ELSE T1.Feb
		END
		) Feb,
		(
		CASE
		WHEN T1.FebSum IS NULL THEN 0
		ELSE T1.FebSum
		END
		) FebSum,
		(
		CASE
		WHEN T1.Mar IS NULL THEN 0
		ELSE T1.Mar
		END
		) Mar,
		(
		CASE
		WHEN T1.MarSum IS NULL THEN 0
		ELSE T1.MarSum
		END
		) MarSum,
		(
		CASE
		WHEN T1.Apr IS NULL THEN 0
		ELSE T1.Apr
		END
		) Apr,
		(
		CASE
		WHEN T1.AprSum IS NULL THEN 0
		ELSE T1.AprSum
		END
		) AprSum,
		(
		CASE
		WHEN T1.May IS NULL THEN 0
		ELSE T1.May
		END
		) May,
		(
		CASE
		WHEN T1.MaySum IS NULL THEN 0
		ELSE T1.MaySum
		END
		) MaySum,
		(
		CASE
		WHEN T1.Jun IS NULL THEN 0
		ELSE T1.Jun
		END
		) Jun,
		(
		CASE
		WHEN T1.JunSum IS NULL THEN 0
		ELSE T1.JunSum
		END
		) JunSum,
		(
		CASE
		WHEN T1.Jul IS NULL THEN 0
		ELSE T1.Jul
		END
		) Jul,
		(
		CASE
		WHEN T1.JulSum IS NULL THEN 0
		ELSE T1.JulSum
		END
		) JulSum,
		(
		CASE
		WHEN T1.Aug IS NULL THEN 0
		ELSE T1.Aug
		END
		) Aug,
		(
		CASE
		WHEN T1.AugSum IS NULL THEN 0
		ELSE T1.AugSum
		END
		) AugSum,
		(
		CASE
		WHEN T1.Sep IS NULL THEN 0
		ELSE T1.Sep
		END
		) Sep,
		(
		CASE
		WHEN T1.SepSum IS NULL THEN 0
		ELSE T1.SepSum
		END
		) SepSum,
		(
		CASE
		WHEN T1.Oct IS NULL THEN 0
		ELSE T1.Oct
		END
		) Oct,
		(
		CASE
		WHEN T1.OctSum IS NULL THEN 0
		ELSE T1.OctSum
		END
		) OctSum,
		(
		CASE
		WHEN T1.Nov IS NULL THEN 0
		ELSE T1.Nov
		END
		) Nov,
		(
		CASE
		WHEN T1.NovSum IS NULL THEN 0
		ELSE T1.NovSum
		END
		) NovSum,
		(
		CASE
		WHEN T1.Dec IS NULL THEN 0
		ELSE T1.Dec
		END
		) Dec,
		(
		CASE
		WHEN T1.DecSum IS NULL THEN 0
		ELSE T1.DecSum
		END
		) DecSum
		FROM COUNTRY_MST
		LEFT JOIN COMPANY_MST
		ON COMPANY_MST.COUNTRY_CD
		= COUNTRY_MST.COUNTRY_CD
		LEFT JOIN DEPT_MST
		ON DEPT_MST.COMPANY_CD = COMPANY_MST.COMPANY_CD
		LEFT JOIN
		( SELECT ORDERS.COUNTRY_CD as countryCd, ORDERS.COMPANY_CD as
		companyCd, ORDERS.DEPT_CD as deptCd,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Jan,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS JanSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Feb,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS FebSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Mar,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS MarSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Apr,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS AprSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS May,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS MaySum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Jun,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS JunSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Jul,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS JulSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Aug,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS AugSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Sep,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS SepSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Oct,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS OctSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS Nov,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS NovSum,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY
		END) AS DEC,
		SUM(
		CASE
		WHEN TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') =
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END) AS DecSum
		FROM ORDERS
		LEFT JOIN ORDER_CFG
		ON ORDER_CFG.ORDER_ID = ORDERS.ORDER_ID
		LEFT JOIN ADDON_MST
		ON ADDON_MST.ADDON_CD = ORDER_CFG.ADDON_CD
		WHERE ORDERS.BILL_FG = '1'
		AND ORDER_CFG.LEASE_TYPE = 'OTC'
		AND TO_CHAR(ORDERS.BILL_MTH_START, 'YYYY') &lt;= #year#
		AND TO_CHAR(ORDERS.BILL_MTH_END, 'YYYY') &gt;=#year#
		GROUP BY ORDERS.COUNTRY_CD, ORDERS.COMPANY_CD, ORDERS.DEPT_CD
		) T1
		ON T1.countryCd = COMPANY_MST.COUNTRY_CD
		AND T1.companyCd =
		COMPANY_MST.COMPANY_CD
		AND T1.deptCd = DEPT_MST.DEPT_CD
		ORDER BY COMPANY_MST.COUNTRY_CD,
		COMPANY_MST.COMPANY_CD, DEPT_MST.DEPT_CD
		)
	</select>

	<select id="getLeaseInvoiceDataKYearlyTotalSummaryDetailMRC"
		parameterClass="jp.co.cyms.apps.fad001.form.Pad0011Form" resultClass="jp.co.cyms.apps.fad001.bean.ReportYearlyBean">
		SELECT *
		FROM
		(SELECT *
		FROM
		(SELECT ORDERS.DEPT_CD AS DEPTCD,
		DEPT_MST.DEPT_NAME AS DEPTNAME,
		ORDERS.COMPANY_CD AS COMPANYCD,
		COMPANY_MST.COMPANY_NAME AS COMPANYNAME,
		ORDER_DTL.ORDER_ID AS orderId,
		ORDER_DTL.CATEGORY_CD AS CATEGORYCD,
		CATEGORY_MST.CATEGORY_NAME AS CATEGORYNAME,
		ORDER_CFG.ADDON_CD AS ADDONCD,
		ADDON_MST.ADDON_name AS ADDONNAME,
		ORDER_CFG.ITEM_CD AS ITEMCD,
		ITEM_MST.ITEM_NAME AS ITEMNAME,
		'MRC' AS costType,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		ELSE NULL
		END AS billableQuantity01 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		ELSE NULL
		END AS billableQuantity02 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		ELSE NULL
		END AS billableQuantity03 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		ELSE NULL
		END AS billableQuantity04 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		ELSE NULL
		END AS billableQuantity05 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		ELSE NULL
		END AS billableQuantity06 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		ELSE NULL
		END AS billableQuantity07 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		ELSE NULL
		END AS billableQuantity08 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		ELSE NULL
		END AS billableQuantity09 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		ELSE NULL
		END AS billableQuantity10 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		ELSE NULL
		END AS billableQuantity11 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		ELSE NULL
		END AS billableQuantity12 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverQuantity01 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverQuantity02 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverQuantity03 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverQuantity04 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverQuantity05 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverQuantity06 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverQuantity07 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverQuantity08 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverQuantity09 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverQuantity10 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverQuantity11 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverQuantity12 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		ELSE NULL
		END billableAmount01 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		ELSE NULL
		END billableAmount02 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		ELSE NULL
		END billableAmount03 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		ELSE NULL
		END billableAmount04 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		ELSE NULL
		END billableAmount05 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		ELSE NULL
		END billableAmount06 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		ELSE NULL
		END billableAmount07 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		ELSE NULL
		END billableAmount08 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		ELSE NULL
		END billableAmount09 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		ELSE NULL
		END billableAmount10 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		ELSE NULL
		END billableAmount11 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		ELSE NULL
		END billableAmount12 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverAmount01,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverAmount02,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverAmount03,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverAmount04,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverAmount05,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverAmount06,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverAmount07,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverAmount08,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverAmount09,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverAmount10,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverAmount11,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		ELSE NULL
		END deliverAmount12
		FROM ORDER_DTL
		INNER JOIN ORDER_CFG
		ON ORDER_DTL.ORDER_ID = ORDER_CFG.ORDER_ID AND ORDER_CFG.LEASE_TYPE =
		'MRC'
		LEFT JOIN CATEGORY_MST
		ON CATEGORY_MST.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		LEFT JOIN ADDON_MST
		ON ADDON_MST.ADDON_CD = ORDER_CFG.ADDON_CD
		LEFT JOIN ORDERS
		ON ORDERS.ORDER_ID = ORDER_DTL.ORDER_ID
		LEFT JOIN ITEM_MST
		ON ITEM_MST.ITEM_CD = ORDER_CFG.ITEM_CD
		LEFT JOIN COMPANY_MST
		ON COMPANY_MST.COMPANY_CD = ORDERS.COMPANY_CD
		LEFT JOIN DEPT_MST
		ON DEPT_MST.DEPT_CD = ORDERS.DEPT_CD AND DEPT_MST.COMPANY_CD =
		ORDERS.COMPANY_CD
		LEFT JOIN
		(SELECT ORDER_ID,
		CATEGORY_CD, ITEM_CD,
		MAX(DELIVER_DT) DELIVER_DT,
		MAX(END_DT) END_DT
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.LEASE_TYPE = 'MRC'
		GROUP BY ORDER_ID,
		CATEGORY_CD, ITEM_CD
		) ORDER_LEASE
		ON ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		WHERE ORDERS.COUNTRY_CD = ITEM_MST.COUNTRY_CD
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM')) &lt;= ORDER_LEASE.END_DT
		AND LAST_DAY(TO_DATE(#year#||'/'||'12', 'YYYY/MM')) >=
		ORDER_LEASE.DELIVER_DT
		AND ORDER_DTL.CATEGORY_CD = ORDER_CFG.CATEGORY_CD
		)
		UNION ALL
		SELECT *
		FROM
		(SELECT ORDERS.DEPT_CD AS DEPTCD,
		DEPT_MST.DEPT_NAME AS DEPTNAME,
		ORDERS.COMPANY_CD AS COMPANYCD,
		COMPANY_MST.COMPANY_NAME AS COMPANYNAME,
		ORDER_DTL.ORDER_ID AS orderId,
		ORDER_DTL.CATEGORY_CD AS CATEGORYCD,
		CATEGORY_MST.CATEGORY_NAME AS CATEGORYNAME,
		'' AS ADDONCD,
		'Model' AS ADDONNAME,
		ORDER_DTL.ITEM_CD AS ITEMCD,
		ITEM_MST.ITEM_NAME AS ITEMNAME ,
		'MRC' AS costType,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity01 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity02 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity03 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity04 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity05 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity06 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity07 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity08 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity09 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity10 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity11 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity12 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(
		(SELECT COUNT(*)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverQuantity01 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(
		(SELECT COUNT(*)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverQuantity02 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(
		(SELECT COUNT(*)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverQuantity03 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(
		(SELECT COUNT(*)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverQuantity04 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(
		(SELECT COUNT(*)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverQuantity05 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(
		(SELECT COUNT(*)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverQuantity06 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(
		(SELECT COUNT(*)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverQuantity07 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(
		(SELECT COUNT(*)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverQuantity08 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(
		(SELECT COUNT(*)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverQuantity09 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(
		(SELECT COUNT(*)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverQuantity10 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(
		(SELECT COUNT(*)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverQuantity11 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(
		(SELECT COUNT(*)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverQuantity12 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount01 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount02 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount03 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount04 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount05 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount06 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount07 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount08 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount09 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount10 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount11 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_DTL.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount12 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_DTL.UNIT_PRICE*
		(SELECT COUNT( *)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverAmount01,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_DTL.UNIT_PRICE*
		(SELECT COUNT( *)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverAmount02,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_DTL.UNIT_PRICE*
		(SELECT COUNT( *)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverAmount03,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_DTL.UNIT_PRICE*
		(SELECT COUNT( *)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverAmount04,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_DTL.UNIT_PRICE*
		(SELECT COUNT( *)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverAmount05,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_DTL.UNIT_PRICE*
		(SELECT COUNT( *)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverAmount06,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_DTL.UNIT_PRICE*
		(SELECT COUNT( *)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverAmount07,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_DTL.UNIT_PRICE*
		(SELECT COUNT( *)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverAmount08,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_DTL.UNIT_PRICE*
		(SELECT COUNT( *)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverAmount09,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_DTL.UNIT_PRICE*
		(SELECT COUNT( *)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverAmount10,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_DTL.UNIT_PRICE*
		(SELECT COUNT( *)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverAmount11,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &gt;=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_DTL.UNIT_PRICE*
		(SELECT COUNT( *)
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		AND ORDER_LEASE.DELIVER_MTH IS NOT NULL
		))
		ELSE NULL
		END deliverAmount12
		FROM ORDER_DTL
		LEFT JOIN CATEGORY_MST
		ON CATEGORY_MST.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		LEFT JOIN ORDERS
		ON ORDERS.ORDER_ID = ORDER_DTL.ORDER_ID
		LEFT JOIN ITEM_MST
		ON ITEM_MST.ITEM_CD = ORDER_DTL.ITEM_CD
		LEFT JOIN COMPANY_MST
		ON COMPANY_MST.COMPANY_CD = ORDERS.COMPANY_CD
		LEFT JOIN DEPT_MST
		ON DEPT_MST.DEPT_CD = ORDERS.DEPT_CD AND DEPT_MST.COMPANY_CD =
		ORDERS.COMPANY_CD
		LEFT JOIN
		(SELECT ORDER_ID,
		CATEGORY_CD, ITEM_CD,
		MAX(DELIVER_DT) DELIVER_DT,
		MAX(END_DT) END_DT
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.LEASE_TYPE = 'MRC'
		GROUP BY ORDER_ID,
		CATEGORY_CD, ITEM_CD
		) ORDER_LEASE
		ON ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		WHERE ORDERS.COUNTRY_CD = ITEM_MST.COUNTRY_CD
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM')) &lt;= ORDER_LEASE.END_DT
		AND LAST_DAY(TO_DATE(#year#||'/'||'12', 'YYYY/MM')) >=
		ORDER_LEASE.DELIVER_DT
		AND ORDER_DTL.ORDER_ID = ORDERS.ORDER_ID
		)
		)
		ORDER BY ORDERID,
		CATEGORYCD,
		CASE
		WHEN ADDONCD IS NULL
		THEN 0
		ELSE 1
		END,
		ADDONNAME DESC

	</select>

	<select id="getLeaseInvoiceDataKYearlyTotalSummaryDetailOTC"
		parameterClass="jp.co.cyms.apps.fad001.form.Pad0011Form" resultClass="jp.co.cyms.apps.fad001.bean.ReportYearlyBean">
		SELECT ORDERS.DEPT_CD AS DEPTCD,
		DEPT_MST.DEPT_NAME AS DEPTNAME,
		ORDERS.COMPANY_CD AS COMPANYCD,
		COMPANY_MST.COMPANY_NAME AS COMPANYNAME,
		ORDER_DTL.ORDER_ID AS ORDERID,
		ORDER_DTL.CATEGORY_CD AS CATEGORYCD,
		CATEGORY_MST.CATEGORY_NAME AS CATEGORYNAME,
		ORDER_CFG.ADDON_CD AS ADDONCD,
		ADDON_MST.ADDON_name AS ADDONNAME,
		ORDER_CFG.ITEM_CD AS ITEMCD,
		ITEM_MST.ITEM_NAME AS ITEMNAME ,
		'OTC' AS costType,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity01 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity02 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity03 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity04 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity05 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity06 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity07 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity08 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity09 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity10 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity11 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.ITEM_QTY
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END AS billableQuantity12 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverQuantity01 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverQuantity02 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverQuantity03 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverQuantity04 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverQuantity05 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverQuantity06 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverQuantity07 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverQuantity08 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverQuantity09 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverQuantity10 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverQuantity11 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverQuantity12 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount01 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount02 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount03 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount04 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount05 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount06 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount07 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount08 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount09 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount10 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount11 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN ORDER_CFG.AMOUNT
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN NULL
		ELSE NULL
		END billableAmount12 ,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.UNIT_PRICE*ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverAmount01,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'2', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.UNIT_PRICE*ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverAmount02,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'3', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.UNIT_PRICE*ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverAmount03,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'4', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.UNIT_PRICE*ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverAmount04,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'5', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.UNIT_PRICE*ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverAmount05,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'6', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.UNIT_PRICE*ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverAmount06,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'7', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.UNIT_PRICE*ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverAmount07,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'8', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.UNIT_PRICE*ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverAmount08,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'9', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.UNIT_PRICE*ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverAmount09,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.UNIT_PRICE*ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverAmount10,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.UNIT_PRICE*ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverAmount11,
		CASE
		WHEN ORDERS.BILL_FG = 1
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') >=
		TRUNC(ORDERS.BILL_MTH_START,'MM')
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') &lt;=
		TRUNC(ORDERS.BILL_MTH_END,'MM')
		THEN '0'
		WHEN ORDERS.BILL_FG IS NULL
		AND TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM') = (SELECT
		TRUNC(MAX(ORDER_LEASE.DELIVER_MTH), 'MM') FROM ORDER_LEASE WHERE
		ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID AND ORDER_LEASE.CATEGORY_CD
		= ORDER_DTL.CATEGORY_CD AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD)
		THEN TO_CHAR(ORDER_CFG.UNIT_PRICE*ORDER_CFG.ITEM_QTY)
		ELSE NULL
		END deliverAmount12
		FROM ORDER_DTL
		INNER JOIN ORDER_CFG
		ON
		ORDER_DTL.ORDER_ID = ORDER_CFG.ORDER_ID AND ORDER_CFG.LEASE_TYPE =
		'OTC'
		LEFT JOIN CATEGORY_MST
		ON CATEGORY_MST.CATEGORY_CD =
		ORDER_DTL.CATEGORY_CD
		LEFT JOIN ADDON_MST
		ON ADDON_MST.ADDON_CD =
		ORDER_CFG.ADDON_CD
		LEFT JOIN ORDERS
		ON ORDERS.ORDER_ID =
		ORDER_DTL.ORDER_ID
		LEFT JOIN ITEM_MST
		ON ITEM_MST.ITEM_CD =
		ORDER_CFG.ITEM_CD
		LEFT JOIN COMPANY_MST
		ON COMPANY_MST.COMPANY_CD = ORDERS.COMPANY_CD
		LEFT JOIN DEPT_MST
		ON DEPT_MST.DEPT_CD = ORDERS.DEPT_CD AND DEPT_MST.COMPANY_CD =
		ORDERS.COMPANY_CD
		LEFT JOIN
		(SELECT ORDER_ID,
		CATEGORY_CD, ITEM_CD,
		MAX(DELIVER_DT) DELIVER_DT,
		MAX(END_DT) END_DT
		FROM ORDER_LEASE
		WHERE ORDER_LEASE.LEASE_TYPE = 'MRC'
		GROUP BY ORDER_ID,
		CATEGORY_CD, ITEM_CD
		) ORDER_LEASE
		ON ORDER_LEASE.ORDER_ID = ORDER_DTL.ORDER_ID
		AND ORDER_LEASE.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		AND ORDER_LEASE.ITEM_CD = ORDER_DTL.ITEM_CD
		WHERE ORDERS.COUNTRY_CD = ITEM_MST.COUNTRY_CD
		AND ORDER_DTL.CATEGORY_CD =
		ORDER_CFG.CATEGORY_CD
		AND TRUNC(TO_DATE(#year#||'/'||'1', 'YYYY/MM')) &lt;= ORDER_LEASE.END_DT
		AND LAST_DAY(TO_DATE(#year#||'/'||'12', 'YYYY/MM')) >=
		ORDER_LEASE.DELIVER_DT
		ORDER BY ORDER_DTL.ORDER_ID,
		ORDER_DTL.CATEGORY_CD,
		CASE
		WHEN ORDER_CFG.ADDON_CD IS NULL
		THEN 0
		ELSE 1
		END,
		ADDON_MST.ADDON_NAME DESC

	</select>

	<!-- Excel PC Lease Invoice Data (K) Yearly Total_Summary -->
	<select id="getLeaseInvoiceDataKYearlyTotalSummary"
		parameterClass="jp.co.cyms.apps.fad001.form.Pad0011Form"
		resultClass="jp.co.cyms.apps.fad001.bean.ExcelPCLeaseInvoiceDataKYearlyBean">
		SELECT rownum AS rowNumber,
		totalSummary.*
		FROM
		(SELECT *
		FROM
		(SELECT 'Monthly Cost' AS costType,
		CATEGORY_MST.CATEGORY_NAME AS categoryName,
		CATEGORY_MST.CATEGORY_CD AS categoryCd,
		ORDER_DTL.ITEM_CD AS itemCd,
		ITEM.ITEM_NAME AS itemName,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS janQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS janAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS febQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS febAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS marQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS marAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS aprQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS aprAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS mayQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS mayAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS junQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS junAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS julQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS julAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS augQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS augAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS sepQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS sepAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS octQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS octAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS novQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS novAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS decQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS decAmount
		FROM ORDER_DTL
		LEFT JOIN ORDERS
		ON ORDERS.ORDER_ID = ORDER_DTL.ORDER_ID
		LEFT JOIN CATEGORY_MST
		ON CATEGORY_MST.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		LEFT JOIN
		(SELECT ITEM_CD,
		ITEM_NAME,
		CATEGORY_CD
		FROM ITEM_MST
		GROUP BY ITEM_CD,
		ITEM_NAME,
		CATEGORY_CD
		) ITEM
		ON ITEM.ITEM_CD = ORDER_DTL.ITEM_CD
		WHERE ORDERS.BILL_FG = '1'
		AND ORDER_DTL.LEASE_TYPE = 'MRC'
		AND TO_CHAR(ORDERS.BILL_MTH_START, 'YYYY') &lt;= #year#
		AND TO_CHAR(ORDERS.BILL_MTH_END, 'YYYY') &gt;= #year#
		GROUP BY ORDER_DTL.CATEGORY_CD,
		ORDER_DTL.ITEM_CD,
		ITEM.ITEM_NAME,
		CATEGORY_MST.CATEGORY_NAME,
		CATEGORY_MST.CATEGORY_CD,
		CATEGORY_MST.DISPLAY_ORDER
		ORDER BY CATEGORY_MST.DISPLAY_ORDER,
		ORDER_DTL.ITEM_CD
		)
		UNION ALL
		SELECT *
		FROM
		(SELECT (
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN 'Monthly Cost'
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN 'One Time Cost'
		END) AS costType,
		CATEGORY_MST.CATEGORY_NAME AS categoryName,
		CATEGORY_MST.CATEGORY_CD AS categoryCd,
		ORDER_CFG.ITEM_CD AS itemCd,
		ITEM.ITEM_NAME AS itemName,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'01',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS janQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'01',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS janAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'02',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS febQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'02',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS febAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'03',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS marQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'03',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS marAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'04',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS aprQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'04',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS aprAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'05',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS mayQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'05',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS mayAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'06',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS junQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'06',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS junAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'07',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS julQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'07',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS julAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'08',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS augQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'08',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS augAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'09',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS sepQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'09',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS sepAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'10',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS octQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'10',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS octAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'11',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS novQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'11',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS novAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'12',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS decQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'12',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS decAmount
		FROM ORDER_CFG
		LEFT JOIN ORDERS
		ON ORDERS.ORDER_ID = ORDER_CFG.ORDER_ID
		LEFT JOIN
		(SELECT ITEM_CD,
		ITEM_NAME,
		CATEGORY_CD
		FROM ITEM_MST
		GROUP BY ITEM_CD,
		ITEM_NAME,
		CATEGORY_CD
		) ITEM
		ON ITEM.ITEM_CD = ORDER_CFG.ITEM_CD
		LEFT JOIN CATEGORY_MST
		ON CATEGORY_MST.CATEGORY_CD = ITEM.CATEGORY_CD
		WHERE ORDERS.BILL_FG = '1'
		AND ORDER_CFG.LEASE_TYPE IN ('OTC', 'MRC')
		AND TO_CHAR(ORDERS.BILL_MTH_START, 'YYYY') &lt;= #year#
		AND TO_CHAR(ORDERS.BILL_MTH_END, 'YYYY') &gt;= #year#
		GROUP BY ORDER_CFG.ITEM_CD,
		ITEM.ITEM_NAME,
		CATEGORY_MST.CATEGORY_NAME,
		CATEGORY_MST.CATEGORY_CD,
		CATEGORY_MST.DISPLAY_ORDER,
		ORDER_CFG.LEASE_TYPE
		ORDER BY ORDER_CFG.LEASE_TYPE,
		CATEGORY_MST.DISPLAY_ORDER,
		ORDER_CFG.ITEM_CD
		)
		) totalSummary
	</select>

	<!-- Excel PC Lease Invoice Data (K) Yearly Company Code -->
	<select id="getLeaseInvoiceDataKYearlyCompanyCode"
		parameterClass="jp.co.cyms.apps.fad001.form.Pad0011Form"
		resultClass="jp.co.cyms.apps.fad001.bean.ExcelPCLeaseInvoiceDataKYearlyBean">
		SELECT rownum AS rowNumber,
		dataByCompanyCode.*
		FROM
		(SELECT *
		FROM
		(SELECT 'Monthly Cost' AS costType,
		COMPANY_MST.COMPANY_CD AS companyCd,
		COMPANY_MST.COMPANY_NAME AS companyName,
		DEPT_MST.DEPT_CD AS deptCd,
		DEPT_MST.DEPT_NAME AS deptName,
		CATEGORY_MST.CATEGORY_NAME AS categoryName,
		CATEGORY_MST.CATEGORY_CD AS categoryCd,
		ORDER_DTL.ITEM_CD AS itemCd,
		ITEM.ITEM_NAME AS itemName,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS janQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS janAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS febQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS febAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS marQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS marAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS aprQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS aprAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS mayQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS mayAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS junQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS junAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS julQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS julAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS augQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS augAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS sepQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS sepAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS octQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS octAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS novQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS novAmount,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY
		END) AS decQty,
		SUM(
		CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		THEN ORDER_DTL.KDDI_DELIVER_QTY*ORDER_DTL.UNIT_PRICE
		END) AS decAmount
		FROM ORDER_DTL
		LEFT JOIN ORDERS
		ON ORDERS.ORDER_ID = ORDER_DTL.ORDER_ID
		LEFT JOIN CATEGORY_MST
		ON CATEGORY_MST.CATEGORY_CD = ORDER_DTL.CATEGORY_CD
		LEFT JOIN
		(SELECT ITEM_CD,
		ITEM_NAME,
		CATEGORY_CD
		FROM ITEM_MST
		GROUP BY ITEM_CD,
		ITEM_NAME,
		CATEGORY_CD
		) ITEM
		ON ITEM.ITEM_CD = ORDER_DTL.ITEM_CD
		LEFT JOIN COMPANY_MST
		ON COMPANY_MST.COMPANY_CD = ORDERS.COMPANY_CD
		LEFT JOIN DEPT_MST
		ON DEPT_MST.DEPT_CD = ORDERS.DEPT_CD
		AND DEPT_MST.COMPANY_CD = ORDERS.COMPANY_CD
		WHERE ORDERS.BILL_FG = '1'
		AND ORDER_DTL.LEASE_TYPE = 'MRC'
		AND TO_CHAR(ORDERS.BILL_MTH_START, 'YYYY') &lt;= #year#
		AND TO_CHAR(ORDERS.BILL_MTH_END, 'YYYY') &gt;= #year#
		GROUP BY ORDER_DTL.CATEGORY_CD,
		ORDER_DTL.ITEM_CD,
		ITEM.ITEM_NAME,
		CATEGORY_MST.CATEGORY_NAME,
		CATEGORY_MST.CATEGORY_CD,
		CATEGORY_MST.DISPLAY_ORDER,
		COMPANY_MST.COMPANY_CD,
		COMPANY_MST.COMPANY_NAME,
		DEPT_MST.DEPT_CD,
		DEPT_MST.DEPT_NAME
		ORDER BY COMPANY_MST.COMPANY_CD,
		DEPT_MST.DEPT_CD,
		CATEGORY_MST.DISPLAY_ORDER,
		ORDER_DTL.ITEM_CD
		)
		UNION ALL
		SELECT *
		FROM
		(SELECT (
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN 'Monthly Cost'
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN 'One Time Cost'
		END) AS costType,
		COMPANY_MST.COMPANY_CD AS companyCd,
		COMPANY_MST.COMPANY_NAME AS companyName,
		DEPT_MST.DEPT_CD AS deptCd,
		DEPT_MST.DEPT_NAME AS deptName,
		CATEGORY_MST.CATEGORY_NAME AS categoryName,
		CATEGORY_MST.CATEGORY_CD AS categoryCd,
		ORDER_CFG.ITEM_CD AS itemCd,
		ITEM.ITEM_NAME AS itemName,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'01',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS janQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'01', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'01',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS janAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'02',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS febQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'02', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'02',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS febAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'03',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS marQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'03', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'03',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS marAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'04',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS aprQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'04', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'04',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS aprAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'05',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS mayQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'05', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'05',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS mayAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'06',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS junQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'06', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'06',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS junAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'07',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS julQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'07', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'07',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS julAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'08',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS augQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'08', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'08',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS augAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'09',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS sepQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'09', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'09',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS sepAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'10',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS octQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'10', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'10',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS octAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'11',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS novQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'11', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'11',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS novAmount,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'12',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY
		END)
		END) AS decQty,
		SUM(
		CASE
		WHEN ORDER_CFG.LEASE_TYPE = 'MRC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') &lt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		AND TRUNC(ORDERS.BILL_MTH_END,'MM') &gt;=
		TRUNC(TO_DATE(#year#||'/'||'12', 'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		WHEN ORDER_CFG.LEASE_TYPE = 'OTC'
		THEN
		(CASE
		WHEN TRUNC(ORDERS.BILL_MTH_START,'MM') = TRUNC(TO_DATE(#year#||'/'||'12',
		'YYYY/MM'),'MM')
		THEN ORDER_CFG.ITEM_QTY*ORDER_CFG.UNIT_PRICE
		END)
		END) AS decAmount
		FROM ORDER_CFG
		LEFT JOIN ORDERS
		ON ORDERS.ORDER_ID = ORDER_CFG.ORDER_ID
		LEFT JOIN
		(SELECT ITEM_CD,
		ITEM_NAME,
		CATEGORY_CD
		FROM ITEM_MST
		GROUP BY ITEM_CD,
		ITEM_NAME,
		CATEGORY_CD
		) ITEM
		ON ITEM.ITEM_CD = ORDER_CFG.ITEM_CD
		LEFT JOIN CATEGORY_MST
		ON CATEGORY_MST.CATEGORY_CD = ITEM.CATEGORY_CD
		LEFT JOIN DEPT_MST
		ON DEPT_MST.DEPT_CD = ORDERS.DEPT_CD
		AND DEPT_MST.COMPANY_CD = ORDERS.COMPANY_CD
		LEFT JOIN COMPANY_MST
		ON COMPANY_MST.COMPANY_CD = ORDERS.COMPANY_CD
		WHERE ORDERS.BILL_FG = '1'
		AND ORDER_CFG.LEASE_TYPE IN ('OTC', 'MRC')
		AND TO_CHAR(ORDERS.BILL_MTH_START, 'YYYY') &lt;= #year#
		AND TO_CHAR(ORDERS.BILL_MTH_END, 'YYYY') &gt;= #year#
		GROUP BY ORDER_CFG.ITEM_CD,
		ITEM.ITEM_NAME,
		CATEGORY_MST.CATEGORY_NAME,
		CATEGORY_MST.CATEGORY_CD,
		CATEGORY_MST.DISPLAY_ORDER,
		ORDER_CFG.LEASE_TYPE,
		COMPANY_MST.COMPANY_CD,
		COMPANY_MST.COMPANY_NAME,
		DEPT_MST.DEPT_CD,
		DEPT_MST.DEPT_NAME
		ORDER BY ORDER_CFG.LEASE_TYPE,
		COMPANY_MST.COMPANY_CD,
		DEPT_MST.DEPT_CD,
		CATEGORY_MST.DISPLAY_ORDER,
		ORDER_CFG.ITEM_CD
		)
		) dataByCompanyCode
	</select>
</sqlMap>